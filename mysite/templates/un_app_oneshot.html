<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UN Document Search - Enhanced Analytics</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .header {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            color: #2d3748;
            margin-bottom: 10px;
        }
        
        .header-stats {
            display: flex;
            gap: 20px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .stat-badge {
            background: linear-gradient(135deg, #4299e1, #3182ce);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }
        
        .search-box {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .search-input {
            width: 100%;
            padding: 15px;
            font-size: 16px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            margin-bottom: 15px;
        }
        
        .search-input:focus {
            outline: none;
            border-color: #4299e1;
        }
        
        .theme-filters {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .theme-btn {
            padding: 8px 16px;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .theme-btn:hover {
            background: #ebf8ff;
            border-color: #4299e1;
        }
        
        .theme-btn.active {
            background: #4299e1;
            color: white;
            border-color: #4299e1;
        }
        
        /* Dashboard Styles */
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .dashboard-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .dashboard-card h3 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .metric-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .metric-item:last-child {
            border-bottom: none;
        }
        
        .metric-label {
            color: #4a5568;
            font-size: 14px;
        }
        
        .metric-value {
            color: #2d3748;
            font-weight: 600;
            font-size: 16px;
        }
        
        .term-bar {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
        }
        
        .term-label {
            min-width: 100px;
            color: #4a5568;
            font-size: 14px;
            font-weight: 500;
        }
        
        .term-bar-bg {
            flex: 1;
            height: 20px;
            background: #e2e8f0;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }
        
        .term-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #4299e1, #3182ce);
            border-radius: 10px;
            transition: width 0.3s ease;
        }
        
        .term-count {
            min-width: 30px;
            text-align: right;
            color: #2d3748;
            font-weight: 600;
            font-size: 14px;
        }
        
        .results-info {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .clear-btn {
            padding: 10px 20px;
            background: #fc8181;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }
        
        .clear-btn:hover {
            background: #f56565;
        }
        
        .toggle-dashboard {
            padding: 10px 20px;
            background: #48bb78;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            margin-left: 10px;
        }
        
        .toggle-dashboard:hover {
            background: #38a169;
        }
        
        .paragraph-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            border-left: 4px solid #4299e1;
        }
        
        .paragraph-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 24px rgba(0,0,0,0.15);
            transition: all 0.3s ease;
        }
        
        .paragraph-id {
            display: inline-block;
            background: #ebf8ff;
            color: #4299e1;
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 15px;
        }
        
        .paragraph-text {
            color: #2d3748;
            line-height: 1.8;
            font-size: 16px;
            margin-bottom: 15px;
        }
        
        .highlight {
            background-color: #fef08a;
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: 600;
        }
        
        .theme-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #e2e8f0;
        }
        
        .theme-tag {
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 13px;
            font-weight: 600;
        }
        
        .tag-0 { background: #fed7d7; color: #c53030; }
        .tag-1 { background: #feebc8; color: #c05621; }
        .tag-2 { background: #fef5c3; color: #975a16; }
        .tag-3 { background: #c6f6d5; color: #22543d; }
        .tag-4 { background: #bee3f8; color: #2c5282; }
        .tag-5 { background: #d6bcfa; color: #553c9a; }
        .tag-6 { background: #fbb6ce; color: #97266d; }
        .tag-7 { background: #b2f5ea; color: #234e52; }
        .tag-8 { background: #fbd38d; color: #7c2d12; }
        .tag-9 { background: #cbd5e0; color: #2d3748; }
        
        .empty-state {
            text-align: center;
            padding: 40px;
            color: #718096;
        }
        
        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .term-label {
                min-width: 80px;
                font-size: 12px;
            }
            
            .header-stats {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîç UN Treaty Body Document Search</h1>
            <p>CCPR General Comment No. 29 - States of Emergency (30 Paragraphs)</p>
            <div class="header-stats">
                <div class="stat-badge">üìÑ 30 Total Paragraphs</div>
                <div class="stat-badge">üè∑Ô∏è 10 UN Themes</div>
                <div class="stat-badge">üìä Live Analytics</div>
            </div>
        </div>
        
        <div class="search-box">
            <input type="text" id="searchInput" class="search-input" placeholder="Search keywords (e.g., 'derogation', 'emergency', 'rights')...">
            <div id="themeFilters" class="theme-filters"></div>
        </div>
        
        <div id="resultsInfo" class="results-info" style="display: none;">
            <span id="resultsCount"></span>
            <div>
                <button class="toggle-dashboard" onclick="toggleDashboard()">üìä Toggle Analytics</button>
                <button class="clear-btn" onclick="clearFilters()">Clear Filters</button>
            </div>
        </div>
        
        <div id="dashboard" class="dashboard">
            <div class="dashboard-card">
                <h3>üìà Document Statistics</h3>
                <div class="metric-item">
                    <span class="metric-label">Filtered Paragraphs</span>
                    <span class="metric-value" id="filteredCount">30</span>
                </div>
                <div class="metric-item">
                    <span class="metric-label">Total Words</span>
                    <span class="metric-value" id="totalWords">0</span>
                </div>
                <div class="metric-item">
                    <span class="metric-label">Unique Terms</span>
                    <span class="metric-value" id="uniqueTerms">0</span>
                </div>
                <div class="metric-item">
                    <span class="metric-label">Avg Words/Para</span>
                    <span class="metric-value" id="avgWords">0</span>
                </div>
            </div>
            
            <div class="dashboard-card">
                <h3>üî§ Top Terms (excl. stopwords)</h3>
                <div id="topTerms"></div>
            </div>
            
            <div class="dashboard-card">
                <h3>üîó Top Bigrams</h3>
                <div id="topBigrams"></div>
            </div>
            
            <div class="dashboard-card">
                <h3>üè∑Ô∏è Theme Distribution</h3>
                <div id="themeDistribution"></div>
            </div>
        </div>
        
        <div id="paragraphs"></div>
    </div>

    <script>
        // Data
        const data = {"paragraphs": [{"Document Name": "General Comment No. 29: states of emergency (article 4)", "Paragraph ID": "1.", "Text": "Article 4 of the Covenant is of paramount importance for the system of protection for human rights under the Covenant. On the one hand, it allows for a State party unilaterally to derogate temporarily from a part of its obligations under the Covenant. On the other hand, article\u00a04 subjects both this very measure of derogation, as well as its material consequences, to a specific regime of safeguards. The restoration of a state of normalcy where full respect for the Covenant can again be secured must be the predominant objective of a State party derogating from the Covenant. In this general comment, replacing its General Comment No 5, adopted at the thirteenth session (1981), the Committee seeks to assist States parties to meet the requirements of article 4.", "Labels": null, "Committee": "CCPR", "Adoption Date": "31 August 2001", "Signature": "CCPR/C/21/Rev.1/Add. 11", "themes": ["Emergency Powers & Derogation", "State Obligations & Reporting", "Proportionality & Necessity"]}, {"Document Name": "General Comment No. 29: states of emergency (article 4)", "Paragraph ID": "2.", "Text": "Measures derogating from the provisions of the Covenant must be of an exceptional and temporary nature. Before a State moves to invoke article 4, two fundamental conditions must be met: the situation must amount to a public emergency which threatens the life of the nation, and the State party must have officially proclaimed a state of emergency. The latter requirement is essential for the maintenance of the principles of legality and rule of law at times when they are most needed. When proclaiming a state of emergency with consequences that could entail derogation from any provision of the Covenant, States must act within their constitutional and other provisions of law that govern such proclamation and the exercise of emergency powers; it is the task of the Committee to monitor the laws in question with respect to whether they enable and secure compliance with article 4. In order that the Committee can perform its task, States parties to the Covenant should include in their reports submitted under article 40 sufficient and precise information about their law and practice in the field of emergency powers.", "Labels": null, "Committee": "CCPR", "Adoption Date": "31 August 2001", "Signature": "CCPR/C/21/Rev.1/Add. 11", "themes": ["Emergency Powers & Derogation", "Rule of Law & Legal Frameworks", "State Obligations & Reporting"]}, {"Document Name": "General Comment No. 29: states of emergency (article 4)", "Paragraph ID": "3.", "Text": "Not every disturbance or catastrophe qualifies as a public emergency which threatens the life of the nation, as required by article 4, paragraph 1. During armed conflict, whether international or non-international, rules of international humanitarian law become applicable and help, in addition to the provisions in article 4 and article 5, paragraph 1, of the Covenant, to prevent the abuse of a State\u2019s emergency powers. The Covenant requires that even during an armed conflict measures derogating from the Covenant are allowed only if and to the extent that the situation constitutes a threat to the life of the nation. If States parties consider invoking article 4 in other situations than an armed conflict, they should carefully consider the justification and why such a measure is necessary and legitimate in the circumstances. On a number of occasions the Committee has expressed its concern over States parties that appear to have derogated from rights protected by the Covenant, or whose domestic law appears to allow such derogation in situations not covered by article 4.", "Labels": "Persons affected by armed conflict", "Committee": "CCPR", "Adoption Date": "31 August 2001", "Signature": "CCPR/C/21/Rev.1/Add. 11", "themes": ["Emergency Powers & Derogation", "Rule of Law & Legal Frameworks", "International Humanitarian Law", "State Obligations & Reporting", "Proportionality & Necessity"]}, {"Document Name": "General Comment No. 29: states of emergency (article 4)", "Paragraph ID": "4.", "Text": "A fundamental requirement for any measures derogating from the Covenant, as set forth in article 4, paragraph 1, is that such measures are limited to the extent strictly required by the exigencies of the situation. This requirement relates to the duration, geographical coverage and material scope of the state of emergency and any measures of derogation resorted to because of the emergency. Derogation from some Covenant obligations in emergency situations is clearly distinct from restrictions or limitations allowed even in normal times under several provisions of the Covenant. Nevertheless, the obligation to limit any derogations to those strictly required by the exigencies of the situation reflects the principle of proportionality which is common to derogation and limitation powers. Moreover, the mere fact that a permissible derogation from a specific provision may, of itself, be justified by the exigencies of the situation does not obviate the requirement that specific measures taken pursuant to the derogation must also be shown to be required by the exigencies of the situation. In practice, this will ensure that no provision of the Covenant, however validly derogated from will be entirely inapplicable to the behaviour of a State party. When considering States parties\u2019 reports the Committee has expressed its concern over insufficient attention being paid to the principle of proportionality.", "Labels": null, "Committee": "CCPR", "Adoption Date": "31 August 2001", "Signature": "CCPR/C/21/Rev.1/Add. 11", "themes": ["Emergency Powers & Derogation", "State Obligations & Reporting", "Proportionality & Necessity"]}, {"Document Name": "General Comment No. 29: states of emergency (article 4)", "Paragraph ID": "5.", "Text": "The issues of when rights can be derogated from, and to what extent, cannot be separated from the provision in article 4, paragraph 1, of the Covenant according to which any measures derogating from a State party\u2019s obligations under the Covenant must be limited \u201cto the extent strictly required by the exigencies of the situation\u201d. This condition requires that States parties provide careful justification not only for their decision to proclaim a state of emergency but also for any specific measures based on such a proclamation. If States purport to invoke the right to derogate from the Covenant during, for instance, a natural catastrophe, a mass demonstration including instances of violence, or a major industrial accident, they must be able to justify not only that such a situation constitutes a threat to the life of the nation, but also that all their measures derogating from the Covenant are strictly required by the exigencies of the situation. In the opinion of the Committee, the possibility of restricting certain Covenant rights under the terms of, for instance, freedom of movement (article 12) or freedom of assembly (article 21) is generally sufficient during such situations and no derogation from the provisions in question would be justified by the exigencies of the situation.", "Labels": null, "Committee": "CCPR", "Adoption Date": "31 August 2001", "Signature": "CCPR/C/21/Rev.1/Add. 11", "themes": ["Emergency Powers & Derogation", "State Obligations & Reporting", "Civil & Political Rights", "Proportionality & Necessity"]}, {"Document Name": "General Comment No. 29: states of emergency (article 4)", "Paragraph ID": "6.", "Text": "The fact that some of the provisions of the Covenant have been listed in article\u00a04 (paragraph\u00a02), as not being subject to derogation does not mean that other articles in the Covenant may be subjected to derogations at will, even where a threat to the life of the nation exists. The legal obligation to narrow down all derogations to those strictly required by the exigencies of the situation establishes both for States parties and for the Committee a duty to conduct a careful analysis under each article of the Covenant based on an objective assessment of the actual situation.", "Labels": null, "Committee": "CCPR", "Adoption Date": "31 August 2001", "Signature": "CCPR/C/21/Rev.1/Add. 11", "themes": ["Emergency Powers & Derogation", "Rule of Law & Legal Frameworks", "State Obligations & Reporting", "Proportionality & Necessity"]}, {"Document Name": "General Comment No. 29: states of emergency (article 4)", "Paragraph ID": "7.", "Text": "Article 4, paragraph 2, of the Covenant explicitly prescribes that no derogation from the following articles may be made: article 6 (right to life), article 7 (prohibition of torture or cruel, inhuman or degrading punishment, or of medical or scientific experimentation without consent), article 8, paragraphs 1 and 2 (prohibition of slavery, slave-trade and servitude), article 11 (prohibition of imprisonment because of inability to fulfil a contractual obligation), article 15 (the principle of legality in the field of criminal law, i.e. the requirement of both criminal liability and punishment being limited to clear and precise provisions in the law that was in place and applicable at the time the act or omission took place, except in cases where a later law imposes a lighter penalty), article 16 (the recognition of everyone as a person before the law), and article 18 (freedom of thought, conscience and religion). The rights enshrined in these provisions are non-derogable by the very fact that they are listed in article 4, paragraph 2. The same applies, in relation to States that are parties to the Second Optional Protocol to the Covenant, aiming at the abolition of the death penalty, as prescribed in article 6 of that Protocol. Conceptually, the qualification of a Covenant provision as a non-derogable one does not mean that no limitations or restrictions would ever be justified. The reference in article 4, paragraph 2, to article 18, a provision that includes a specific clause on restrictions in its paragraph 3, demonstrates that the permissibility of restrictions is independent of the issue of derogability. Even in times of most serious public emergencies, States that interfere with the freedom to manifest one\u2019s religion or belief must justify their actions by referring to the requirements specified in article 18, paragraph 3. On several occasions the Committee has expressed its concern about rights that are non-derogable according to article 4, paragraph 2, being either derogated from or under a risk of derogation owing to inadequacies in the legal regime of the State party.", "Labels": null, "Committee": "CCPR", "Adoption Date": "31 August 2001", "Signature": "CCPR/C/21/Rev.1/Add. 11", "themes": ["Emergency Powers & Derogation", "Non-derogable Rights", "Rule of Law & Legal Frameworks", "Non-discrimination & Equality", "State Obligations & Reporting", "Due Process & Fair Trial", "Proportionality & Necessity"]}, {"Document Name": "General Comment No. 29: states of emergency (article 4)", "Paragraph ID": "8.", "Text": "According to article 4, paragraph 1, one of the conditions for the justifiability of any derogation from the Covenant is that the measures taken do not involve discrimination solely on the ground of race, colour, sex, language, religion or social origin. Even though article 26 or the other Covenant provisions related to non-discrimination (articles 2, 3, 14, paragraph 1, 23, paragraph 4, 24, paragraph 1, and 25) have not been listed among the non-derogable provisions in article 4, paragraph 2, there are elements or dimensions of the right to non-discrimination that cannot be derogated from in any circumstances. In particular, this provision of article 4, paragraph 1, must be complied with if any distinctions between persons are made when resorting to measures that derogate from the Covenant.", "Labels": null, "Committee": "CCPR", "Adoption Date": "31 August 2001", "Signature": "CCPR/C/21/Rev.1/Add. 11", "themes": ["Emergency Powers & Derogation", "Non-derogable Rights", "Non-discrimination & Equality"]}, {"Document Name": "General Comment No. 29: states of emergency (article 4)", "Paragraph ID": "9.", "Text": "Furthermore, article 4, paragraph 1, requires that no measure derogating from the provisions of the Covenant may be inconsistent with the State party\u2019s other obligations under international law, particularly the rules of international humanitarian law. Article 4 of the Covenant cannot be read as justification for derogation from the Covenant if such derogation would entail a breach of the State\u2019s other international obligations, whether based on treaty or general international law. This is reflected also in article 5, paragraph 2, of the Covenant according to which there shall be no restriction upon or derogation from any fundamental rights recognized in other instruments on the pretext that the Covenant does not recognize such rights or that it recognizes them to a lesser extent.", "Labels": null, "Committee": "CCPR", "Adoption Date": "31 August 2001", "Signature": "CCPR/C/21/Rev.1/Add. 11", "themes": ["Emergency Powers & Derogation", "Rule of Law & Legal Frameworks", "International Humanitarian Law", "State Obligations & Reporting"]}, {"Document Name": "General Comment No. 29: states of emergency (article 4)", "Paragraph ID": "10.", "Text": "Although it is not the function of the Human Rights Committee to review the conduct of a State party under other treaties, in exercising its functions under the Covenant the Committee has the competence to take a State party\u2019s other international obligations into account when it considers whether the Covenant allows the State party to derogate from specific provisions of the Covenant. Therefore, when invoking article 4, paragraph 1, or when reporting under article\u00a040 on the legal framework related to emergencies, States parties should present information on their other international obligations relevant for the protection of the rights in question, in particular those obligations that are applicable in times of emergency. In this respect, States parties should duly take into account the developments within international law as to human rights standards applicable in emergency situations.", "Labels": null, "Committee": "CCPR", "Adoption Date": "31 August 2001", "Signature": "CCPR/C/21/Rev.1/Add. 11", "themes": ["Emergency Powers & Derogation", "Rule of Law & Legal Frameworks", "International Humanitarian Law", "State Obligations & Reporting"]}, {"Document Name": "General Comment No. 29: states of emergency (article 4)", "Paragraph ID": "11.", "Text": "The enumeration of non-derogable provisions in article 4 is related to, but not identical with, the question whether certain human rights obligations bear the nature of peremptory norms of international law. The proclamation of certain provisions of the Covenant as being of a non\u2011derogable nature, in article 4, paragraph 2, is to be seen partly as recognition of the peremptory nature of some fundamental rights ensured in treaty form in the Covenant (e.g., articles\u00a06 and 7). However, it is apparent that some other provisions of the Covenant were included in the list of non-derogable provisions because it can never become necessary to derogate from these rights during a state of emergency (e.g., articles 11 and 18). Furthermore, the category of peremptory norms extends beyond the list of non-derogable provisions as given in article 4, paragraph 2. States parties may in no circumstances invoke article 4 of the Covenant as justification for acting in violation of humanitarian law or peremptory norms of international law, for instance by taking hostages, by imposing collective punishments, through arbitrary deprivations of liberty or by deviating from fundamental principles of fair trial, including the presumption of innocence.", "Labels": null, "Committee": "CCPR", "Adoption Date": "31 August 2001", "Signature": "CCPR/C/21/Rev.1/Add. 11", "themes": ["Emergency Powers & Derogation", "Non-derogable Rights", "Rule of Law & Legal Frameworks", "International Humanitarian Law", "State Obligations & Reporting", "Due Process & Fair Trial", "Proportionality & Necessity"]}, {"Document Name": "General Comment No. 29: states of emergency (article 4)", "Paragraph ID": "12.", "Text": "In assessing the scope of legitimate derogation from the Covenant, one criterion can be found in the definition of certain human rights violations as crimes against humanity. If action conducted under the authority of a State constitutes a basis for individual criminal responsibility for a crime against humanity by the persons involved in that action, article 4 of the Covenant cannot be used as justification that a state of emergency exempted the State in question from its responsibility in relation to the same conduct. Therefore, the recent codification of crimes against humanity, for jurisdictional purposes, in the Rome Statute of the International Criminal Court is of relevance in the interpretation of article 4 of the Covenant.", "Labels": null, "Committee": "CCPR", "Adoption Date": "31 August 2001", "Signature": "CCPR/C/21/Rev.1/Add. 11", "themes": ["Emergency Powers & Derogation", "Due Process & Fair Trial"]}, {"Document Name": "General Comment No. 29: states of emergency (article 4)", "Paragraph ID": "13.", "Text": "In those provisions of the Covenant that are not listed in article 4, paragraph 2, there are elements that in the Committee\u2019s opinion cannot be made subject to lawful derogation under article 4. Some illustrative examples are presented below.\n(a)All persons deprived of their liberty shall be treated with humanity and with respect for the inherent dignity of the human person. Although this right, prescribed in article 10 of the Covenant, is not separately mentioned in the list of non-derogable rights in article 4, paragraph 2, the Committee believes that here the Covenant expresses a norm of general international law not subject to derogation. This is supported by the reference to the inherent dignity of the human person in the preamble to the Covenant and by the close connection between articles 7 and 10.\n(b)The prohibitions against taking of hostages, abductions or unacknowledged detention are not subject to derogation. The absolute nature of these prohibitions, even in times of emergency, is justified by their status as norms of general international law.\n(c)The Committee is of the opinion that the international protection of the rights of persons belonging to minorities includes elements that must be respected in all circumstances. This is reflected in the prohibition against genocide in international law, in the inclusion of a non-discrimination clause in article 4 itself (paragraph 1), as well as in the non-derogable nature of article 18.\n(d)As confirmed by the Rome Statute of the International Criminal Court, deportation or forcible transfer of population without grounds permitted under international law, in the form of forced displacement by expulsion or other coercive means from the area in which the persons concerned are lawfully present, constitutes a crime against humanity. The legitimate right to derogate from article 12 of the Covenant during a state of emergency can never be accepted as justifying such measures.\n(e)No declaration of a state of emergency made pursuant to article 4, paragraph 1, may be invoked as justification for a State party to engage itself, contrary to article 20, in propaganda for war, or in advocacy of national, racial or religious hatred that would constitute incitement to discrimination, hostility or violence.", "Labels": "Persons deprived of their liberty, Internally displaced persons", "Committee": "CCPR", "Adoption Date": "31 August 2001", "Signature": "CCPR/C/21/Rev.1/Add. 11", "themes": ["Emergency Powers & Derogation", "Non-derogable Rights", "Rule of Law & Legal Frameworks", "Non-discrimination & Equality", "Vulnerable Groups Protection", "International Humanitarian Law", "State Obligations & Reporting", "Civil & Political Rights", "Due Process & Fair Trial", "Proportionality & Necessity"]}, {"Document Name": "General Comment No. 29: states of emergency (article 4)", "Paragraph ID": "14.", "Text": "Article 2, paragraph 3, of the Covenant requires a State party to the Covenant to provide remedies for any violation of the provisions of the Covenant. This clause is not mentioned in the list of non-derogable provisions in article 4, paragraph 2, but it constitutes a treaty obligation inherent in the Covenant as a whole. Even if a State party, during a state of emergency, and to the extent that such measures are strictly required by the exigencies of the situation, may introduce adjustments to the practical functioning of its procedures governing judicial or other remedies, the State party must comply with the fundamental obligation, under article 2, paragraph 3, of the Covenant to provide a remedy that is effective.", "Labels": null, "Committee": "CCPR", "Adoption Date": "31 August 2001", "Signature": "CCPR/C/21/Rev.1/Add. 11", "themes": ["Emergency Powers & Derogation", "Non-derogable Rights", "International Humanitarian Law", "State Obligations & Reporting", "Proportionality & Necessity"]}, {"Document Name": "General Comment No. 29: states of emergency (article 4)", "Paragraph ID": "15.", "Text": "It is inherent in the protection of rights explicitly recognized as non-derogable in article\u00a04, paragraph 2, that they must be secured by procedural guarantees, including, often, judicial guarantees. The provisions of the Covenant relating to procedural safeguards may never be made subject to measures that would circumvent the protection of non-derogable rights. Article 4 may not be resorted to in a way that would result in derogation from non-derogable rights. Thus, for example, as article 6 of the Covenant is non-derogable in its entirety, any trial leading to the imposition of the death penalty during a state of emergency must conform to the provisions of the Covenant, including all the requirements of articles 14 and 15.", "Labels": null, "Committee": "CCPR", "Adoption Date": "31 August 2001", "Signature": "CCPR/C/21/Rev.1/Add. 11", "themes": ["Emergency Powers & Derogation", "Non-derogable Rights"]}, {"Document Name": "General Comment No. 29: states of emergency (article 4)", "Paragraph ID": "16.", "Text": "Safeguards related to derogation, as embodied in article 4 of the Covenant, are based on the principles of legality and the rule of law inherent in the Covenant as a whole. As certain elements of the right to a fair trial are explicitly guaranteed under international humanitarian law during armed conflict, the Committee finds no justification for derogation from these guarantees during other emergency situations. The Committee is of the opinion that the principles of legality and the rule of law require that fundamental requirements of fair trial must be respected during a state of emergency. Only a court of law may try and convict a person for a criminal offence. The presumption of innocence must be respected. In order to protect non-derogable rights, the right to take proceedings before a court to enable the court to decide without delay on the lawfulness of detention, must not be diminished by a State party\u2019s decision to derogate from the Covenant.", "Labels": null, "Committee": "CCPR", "Adoption Date": "31 August 2001", "Signature": "CCPR/C/21/Rev.1/Add. 11", "themes": ["Emergency Powers & Derogation", "Non-derogable Rights", "Rule of Law & Legal Frameworks", "International Humanitarian Law", "State Obligations & Reporting", "Due Process & Fair Trial"]}, {"Document Name": "General Comment No. 29: states of emergency (article 4)", "Paragraph ID": "17.", "Text": "In paragraph 3 of article 4, States parties, when they resort to their power of derogation under article 4, commit themselves to a regime of international notification. A State party availing itself of the right of derogation must immediately inform the other States parties, through the United\u00a0Nations Secretary\u2011General, of the provisions it has derogated from and of the reasons for such measures. Such notification is essential not only for the discharge of the Committee\u2019s functions, in particular in assessing whether the measures taken by the State party were strictly required by the exigencies of the situation, but also to permit other States parties to monitor compliance with the provisions of the Covenant. In view of the summary character of many of the notifications received in the past, the Committee emphasizes that the notification by States parties should include full information about the measures taken and a clear explanation of the reasons for them, with full documentation attached regarding their law. Additional notifications are required if the State party subsequently takes further measures under article 4, for instance by extending the duration of a state of emergency. The requirement of immediate notification applies equally in relation to the termination of derogation. These obligations have not always been respected: States parties have failed to notify other States parties, through the Secretary-General, of a proclamation of a state of emergency and of the resulting measures of derogation from one or more provisions of the Covenant, and States parties have sometimes neglected to submit a notification of territorial or other changes in the exercise of their emergency powers.\u2019Sometimes, the existence of a state of emergency and the question of whether a State party has derogated from provisions of the Covenant have come to the attention of the Committee only incidentally, in the course of the consideration of a State party\u2019s report. The Committee emphasizes the obligation of immediate international notification whenever a State party takes measures derogating from its obligations under the Covenant. The duty of the Committee to monitor the law and practice of a State party for compliance with article 4 does not depend on whether that State party has submitted a notification.", "Labels": null, "Committee": "CCPR", "Adoption Date": "31 August 2001", "Signature": "CCPR/C/21/Rev.1/Add. 11", "themes": ["Emergency Powers & Derogation", "Rule of Law & Legal Frameworks", "Non-discrimination & Equality", "State Obligations & Reporting", "Proportionality & Necessity"]}, {"Document Name": "General Comment No. 23: the rights of minorities (art. 27)", "Paragraph ID": "1.", "Text": "Article 27 of the Covenant provides that, in those States in which ethnic, religious or linguistic minorities exist, persons belonging to these minorities shall not be denied the right, in community with the other members of their group, to enjoy their own culture, to profess and practice their own religion, or to use their own language.\u00a0 The Committee observes that this article establishes and recognizes a right which is conferred on individuals belonging to minority groups and which is distinct from, and additional to, all the other rights which, as individuals in common with everyone else, they are already entitled to enjoy under the Covenant.", "Labels": null, "Committee": "CCPR", "Adoption Date": "26 April 1994", "Signature": "CCPR/C/21/Rev.1/Add.5", "themes": ["Non-discrimination & Equality", "Vulnerable Groups Protection", "State Obligations & Reporting"]}, {"Document Name": "General Comment No. 23: the rights of minorities (art. 27)", "Paragraph ID": "2.", "Text": "\u00a0In some communications submitted to the Committee under the Optional Protocol, the right protected under article 27 has been confused with the right of peoples to self-determination proclaimed in article 1 of the Covenant.\u00a0 Further, in reports submitted by States parties under article 40 of the Covenant, the obligations placed upon States parties under article 27 have sometimes been confused with their duty under article 2(1) to ensure the enjoyment of the rights guaranteed under the Covenant without discrimination and also with equality before the law and equal protection of the law under article 26.", "Labels": null, "Committee": "CCPR", "Adoption Date": "26 April 1994", "Signature": "CCPR/C/21/Rev.1/Add.5", "themes": ["Emergency Powers & Derogation", "Rule of Law & Legal Frameworks", "Non-discrimination & Equality", "State Obligations & Reporting"]}, {"Document Name": "General Comment No. 23: the rights of minorities (art. 27)", "Paragraph ID": "3.", "Text": "1. The Covenant draws a distinction between the right to self- determination and the rights protected under article 27.  The former is expressed to be a right belonging to peoples and is dealt with in a separate part (Part I) of the Covenant. Self-determination is not a right cognizable under the Optional Protocol.  Article 27, on the other hand, relates to rights conferred on individuals as such and is included, like the articles relating to other personal rights conferred on individuals, in Part III of the Covenant and is cognizable under the Optional Protocol 1/.\n2  The enjoyment of the rights to which article 27 relates does not prejudice the sovereignty and territorial integrity of a State party.  At the same time, one or other aspect of the rights of individuals protected under that article - for example, to enjoy a particular culture - may consist in a way of life which is closely associated with territory and use of its resources.  This may particularly be true of members of indigenous communities constituting a minority.", "Labels": "Indigenous peoples", "Committee": "CCPR", "Adoption Date": "26 April 1994", "Signature": "CCPR/C/21/Rev.1/Add.5", "themes": ["Vulnerable Groups Protection", "State Obligations & Reporting"]}, {"Document Name": "General Comment No. 23: the rights of minorities (art. 27)", "Paragraph ID": "4.", "Text": "The Covenant also distinguishes the rights protected under article 27 from the guarantees under articles 2(1) and 26.\u00a0 The entitlement, under article 2(1), to enjoy the rights under the Covenant without discrimination applies to all individuals within the territory or under the jurisdiction of the State whether or not those persons belong to a minority.\u00a0 In addition, there is a distinct right provided under article 26 for equality before the law, equal protection of the law, and non-discrimination in respect of rights granted and obligations imposed by the States. It governs the exercise of all rights, whether protected under the Covenant or not, which the State party confers by law on individuals within its territory or under its jurisdiction, irrespective of whether they belong to the minorities specified in article 27 or not.\u00a0 Some States parties who claim that they do not discriminate on grounds of ethnicity, language or religion, wrongly contend, on that basis alone, that they have no minorities.", "Labels": null, "Committee": "CCPR", "Adoption Date": "26 April 1994", "Signature": "CCPR/C/21/Rev.1/Add.5", "themes": ["Rule of Law & Legal Frameworks", "Non-discrimination & Equality", "Vulnerable Groups Protection", "State Obligations & Reporting"]}, {"Document Name": "General Comment No. 23: the rights of minorities (art. 27)", "Paragraph ID": "5.", "Text": "1. The terms used in article 27 indicate that the persons designed to be protected are those who belong to a group and who share in common a culture, a religion and/or a language.  Those terms also indicate that the individuals designed to be protected need not be citizens of the State party.  In this regard, the obligations deriving from article 2(1) are also relevant, since a State party is required under that article to ensure that the rights protected under the Covenant are available to all individuals within its territory and subject to its jurisdiction, except rights which are expressly made to apply to citizens, for example, political rights under article 25.  A State party may not, therefore, restrict the rights under article 27 to its citizens alone.\n2. Article 27 confers rights on persons belonging to minorities which \"exist\" in a State party.  Given the nature and scope of the rights envisaged under that article, it is not relevant to determine the degree of permanence that the term \"exist\" connotes. Those rights simply are that individuals belonging to those minorities should not be denied the right, in community with members of their group, to enjoy their own culture, to practice their religion and speak their language.  Just as they need not be nationals or citizens, they need not be permanent residents. Thus, migrant workers or even visitors in a State party constituting such minorities are entitled not to be denied the exercise of those rights.  As any other individual in the territory of the State party, they would, also for this purpose, have the general rights, for example, to freedom of association, of assembly, and of expression.  The existence of an ethnic, religious or linguistic minority in a given State party does not depend upon a decision by that State party but requires to be established by objective criteria.\n3. The right of individuals belonging to a linguistic minority to use their language among themselves, in private or in public, is distinct from other language rights protected under the Covenant.  In particular, it should be distinguished from the general right to freedom of expression protected under article 19.  The latter right is available to all persons, irrespective of whether they belong to minorities or not. Further, the right protected under article 27 should be distinguished from the particular right which article 14(3)(f) of the Covenant confers on accused persons to interpretation where they cannot understand or speak the language used in the courts. Article 14(3)(f) does not, in any other circumstances, confer on accused persons the right to use or speak the language of their choice in court proceedings.", "Labels": "Migrants", "Committee": "CCPR", "Adoption Date": "26 April 1994", "Signature": "CCPR/C/21/Rev.1/Add.5", "themes": ["Non-discrimination & Equality", "Vulnerable Groups Protection", "State Obligations & Reporting", "Civil & Political Rights", "Due Process & Fair Trial", "Proportionality & Necessity"]}, {"Document Name": "General Comment No. 23: the rights of minorities (art. 27)", "Paragraph ID": "6.", "Text": "1. Although article 27 is expressed in negative terms, that article, nevertheless, does recognize the existence of a \"right\" and requires that it shall not be denied.  Consequently, a State party is under an obligation to ensure that the existence and the exercise of this right are protected against their denial or violation.  Positive measures of protection are, therefore, required not only against the acts of the State party itself, whether through its legislative, judicial or administrative authorities, but also against the acts of other persons within the State party.\n2.  Although the rights protected under article 27 are individual rights, they depend in turn on the ability of the minority group to maintain its culture, language or religion.\nAccordingly, positive measures by States may also be necessary to protect the identity of a minority and the rights of its members to enjoy and develop their culture and language and to practice their religion, in community with the other members of the group. In this connection, it has to be observed that such positive measures must respect the provisions of articles 2(1) and 26 of the Covenant both as regards the treatment between different minorities and the treatment between the persons belonging to them and the remaining part of the population.  However, as long as those measures are aimed at correcting conditions which prevent or impair the enjoyment of the rights guaranteed under article 27, they may constitute a legitimate differentiation under the Covenant, provided that they are based on reasonable and objective criteria.", "Labels": null, "Committee": "CCPR", "Adoption Date": "26 April 1994", "Signature": "CCPR/C/21/Rev.1/Add.5", "themes": ["Non-discrimination & Equality", "Vulnerable Groups Protection", "State Obligations & Reporting", "Proportionality & Necessity"]}, {"Document Name": "General Comment No. 23: the rights of minorities (art. 27)", "Paragraph ID": "7.", "Text": "With regard to the exercise of the cultural rights protected under article 27, the Committee observes that culture manifests itself in many forms, including a particular way of life associated with the use of land resources, specially in the case of indigenous peoples.\u00a0 That right may include such traditional activities as fishing or hunting and the right to live in reserves protected by law 5/.\u00a0 The enjoyment of those rights may require positive legal measures of protection and measures to ensure the effective participation of members of minority communities in decisions which affect them.", "Labels": "Indigenous peoples", "Committee": "CCPR", "Adoption Date": "26 April 1994", "Signature": "CCPR/C/21/Rev.1/Add.5", "themes": ["Rule of Law & Legal Frameworks", "Vulnerable Groups Protection", "State Obligations & Reporting"]}, {"Document Name": "General Comment No. 23: the rights of minorities (art. 27)", "Paragraph ID": "8.", "Text": "The Committee observes that none of the rights protected under article 27 of the Covenant may be legitimately exercised in a manner or to an extent inconsistent with the other provisions of the Covenant.", "Labels": null, "Committee": "CCPR", "Adoption Date": "26 April 1994", "Signature": "CCPR/C/21/Rev.1/Add.5", "themes": ["State Obligations & Reporting"]}, {"Document Name": "General Comment No. 23: the rights of minorities (art. 27)", "Paragraph ID": "9.", "Text": "The Committee concludes that article 27 relates to rights whose protection imposes specific obligations on States parties. The protection of these rights is directed to ensure the survival and continued development of the cultural, religious and social identity of the minorities concerned, thus enriching the fabric of society as a whole.\u00a0 Accordingly, the Committee observes that these rights must be protected as such and should not be confused with other personal rights conferred on one and all under the Covenant.\u00a0 States parties, therefore, have an obligation to ensure that the exercise of these rights is fully protected and they should indicate in their reports the measures they have adopted to this end.", "Labels": null, "Committee": "CCPR", "Adoption Date": "26 April 1994", "Signature": "CCPR/C/21/Rev.1/Add.5", "themes": ["Vulnerable Groups Protection", "State Obligations & Reporting"]}, {"Document Name": "General Comment No. 22: the right to freedom of thought, conscience and religion (art. 18)", "Paragraph ID": "1.", "Text": "The right to freedom of thought, conscience and religion (which includes the freedom to hold beliefs) in article 18 (1) is far-reaching and profound; it encompasses freedom of thoughts on all matters, personal conviction and the commitment to religion or belief, whether manifested individually or in community with others. The Committee draws the attention of States parties to the fact that the freedom of thought and the freedom of conscience are protected equally with the freedom of religion and belief. The fundamental character of these freedoms is also reflected in the fact that this provision cannot be derogated from, even in time of public emergency, as stated in article 4 (2) of the Covenant.\u00a0", "Labels": null, "Committee": "CCPR", "Adoption Date": "27 September 1993", "Signature": "CCPR/C/21/Rev.1/Add. 4", "themes": ["Emergency Powers & Derogation", "Non-derogable Rights", "Non-discrimination & Equality", "State Obligations & Reporting"]}, {"Document Name": "General Comment No. 22: the right to freedom of thought, conscience and religion (art. 18)", "Paragraph ID": "2.", "Text": "Article 18 protects theistic, non-theistic and atheistic beliefs, as well as the right not to profess any religion or belief. The terms belief and religion are to be broadly construed. Article 18 is not limited in its application to traditional religions or to religions and beliefs with institutional characteristics or practices analogous to those of traditional religions. The Committee therefore views with concern any tendency to discriminate against any religion or belief for any reasons, including the fact that they are newly established, or represent religious minorities that may be the subject of hostility by a predominant religious community.\u00a0", "Labels": null, "Committee": "CCPR", "Adoption Date": "27 September 1993", "Signature": "CCPR/C/21/Rev.1/Add. 4", "themes": ["Non-derogable Rights", "Non-discrimination & Equality", "Vulnerable Groups Protection", "State Obligations & Reporting"]}, {"Document Name": "General Comment No. 22: the right to freedom of thought, conscience and religion (art. 18)", "Paragraph ID": "3.", "Text": "Article 18 distinguishes the freedom of thought, conscience, religion or belief from the freedom to manifest religion or belief. It does not permit any limitations whatsoever on the freedom of thought and conscience or on the freedom to have or adopt a religion or belief of one\u2019s choice. These freedoms are protected unconditionally, as is the right of everyone to hold opinions without interference in article 19 (1). In accordance with articles 18 (2) and 17, no one can be compelled to reveal his thoughts or adherence to a religion or belief.\u00a0", "Labels": null, "Committee": "CCPR", "Adoption Date": "27 September 1993", "Signature": "CCPR/C/21/Rev.1/Add. 4", "themes": ["Non-derogable Rights", "Non-discrimination & Equality", "Civil & Political Rights"]}, {"Document Name": "General Comment No. 22: the right to freedom of thought, conscience and religion (art. 18)", "Paragraph ID": "4.\u00a0", "Text": "The freedom to manifest religion or belief may be exercised \"either individually or in community with others and in public or private\". The freedom to manifest religion or belief in worship, observance, practice and teaching encompasses a broad range of acts. The concept of worship extends to ritual and ceremonial acts giving direct expression to belief, as well as various practices integral to such acts, including the building of places of worship, the use of ritual formulae and objects, the display of symbols, and the observance of holidays and days of rest. The observance and practice of religion or belief may include not only ceremonial acts but also such customs as the observance of dietary regulations, the wearing of distinctive clothing or headcoverings, participation in rituals associated with certain stages of life, and the use of a particular language customarily spoken by a group. In addition, the practice and teaching of religion or belief includes acts integral to the conduct by religious groups of their basic affairs, such as, inter alia, the freedom to choose their religious leaders, priests and teachers, the freedom to establish seminaries or religious schools and the freedom to prepare and distribute religious texts or publications.\u00a0", "Labels": null, "Committee": "CCPR", "Adoption Date": "27 September 1993", "Signature": "CCPR/C/21/Rev.1/Add. 4", "themes": ["Non-discrimination & Equality"]}], "theme_definitions": {"Emergency Powers & Derogation": {"keywords": ["emergency", "derogation", "derogate", "exceptional", "temporary", "proclaim", "state of emergency"], "description": "Provisions related to states of emergency and temporary derogation from treaty obligations"}, "Non-derogable Rights": {"keywords": ["non-derogable", "article 4, paragraph 2", "right to life", "torture", "slavery", "article 6", "article 7", "article 15", "article 18"], "description": "Core rights that cannot be suspended even during emergencies"}, "Rule of Law & Legal Frameworks": {"keywords": ["rule of law", "legality", "constitutional", "legal", "law", "legislation", "principles of law", "legal obligation"], "description": "Legal frameworks, constitutional provisions, and rule of law principles"}, "Non-discrimination & Equality": {"keywords": ["discrimination", "race", "colour", "sex", "language", "religion", "social origin", "equality", "equal", "article 26"], "description": "Prohibition of discrimination and guarantee of equality before the law"}, "Vulnerable Groups Protection": {"keywords": ["children", "women", "indigenous", "disabilities", "migrants", "internally displaced", "minorities", "refugees"], "description": "Special protections for vulnerable populations and marginalized groups"}, "International Humanitarian Law": {"keywords": ["humanitarian law", "armed conflict", "international law", "treaty", "international obligations", "geneva conventions"], "description": "Intersection with international humanitarian law and other international obligations"}, "State Obligations & Reporting": {"keywords": ["state party", "obligation", "article 40", "report", "committee", "monitoring", "compliance", "implementation"], "description": "State duties under the Covenant and reporting requirements to treaty bodies"}, "Civil & Political Rights": {"keywords": ["freedom of movement", "freedom of assembly", "freedom of expression", "article 12", "article 21", "article 19", "political rights"], "description": "Specific civil and political rights protected under the Covenant"}, "Due Process & Fair Trial": {"keywords": ["fair trial", "due process", "criminal", "presumption of innocence", "arbitrary", "detention", "judiciary", "court"], "description": "Guarantees of fair trial, due process, and judicial protections"}, "Proportionality & Necessity": {"keywords": ["proportionality", "strictly required", "necessary", "exigencies", "justified", "assessment", "objective"], "description": "Requirement that any restrictions be proportionate and strictly necessary"}}};

        // Stopwords list
        const stopwords = new Set([
            'the', 'be', 'to', 'of', 'and', 'a', 'in', 'that', 'have', 'i',
            'it', 'for', 'not', 'on', 'with', 'he', 'as', 'you', 'do', 'at',
            'this', 'but', 'his', 'by', 'from', 'they', 'we', 'say', 'her', 'she',
            'or', 'an', 'will', 'my', 'one', 'all', 'would', 'there', 'their',
            'what', 'so', 'up', 'out', 'if', 'about', 'who', 'get', 'which', 'go',
            'me', 'when', 'make', 'can', 'like', 'time', 'no', 'just', 'him', 'know',
            'take', 'into', 'year', 'your', 'good', 'some', 'could', 'them', 'see',
            'other', 'than', 'then', 'now', 'look', 'only', 'come', 'its', 'over',
            'think', 'also', 'back', 'after', 'use', 'two', 'how', 'our', 'work',
            'first', 'well', 'way', 'even', 'new', 'want', 'because', 'any', 'these',
            'give', 'day', 'most', 'us', 'is', 'was', 'are', 'been', 'has', 'had',
            'were', 'said', 'did', 'having', 'may', 'should', 'must', 'shall',
            'such', 'being', 'does', 'very', 'where', 'each', 'those', 'both',
            'under', 'however', 'whether'
        ]);

        let selectedThemes = [];
        let searchTerm = '';
        let dashboardVisible = true;
        const allThemes = Object.keys(data.theme_definitions);
        
        // Initialize
        function init() {
            renderThemeFilters();
            renderParagraphs();
            updateDashboard();
            
            document.getElementById('searchInput').addEventListener('input', function(e) {
                searchTerm = e.target.value;
                renderParagraphs();
                updateDashboard();
            });
        }
        
        // Render theme filters
        function renderThemeFilters() {
            const container = document.getElementById('themeFilters');
            container.innerHTML = allThemes.map(theme => 
                `<button class="theme-btn" onclick="toggleTheme('${theme}')" id="theme-${theme.replace(/[^a-zA-Z0-9]/g, '')}">${theme}</button>`
            ).join('');
        }
        
        // Toggle theme
        function toggleTheme(theme) {
            const index = selectedThemes.indexOf(theme);
            if (index > -1) {
                selectedThemes.splice(index, 1);
            } else {
                selectedThemes.push(theme);
            }
            
            const btn = document.getElementById('theme-' + theme.replace(/[^a-zA-Z0-9]/g, ''));
            btn.classList.toggle('active');
            
            renderParagraphs();
            updateDashboard();
        }
        
        // Clear filters
        function clearFilters() {
            searchTerm = '';
            selectedThemes = [];
            document.getElementById('searchInput').value = '';
            document.querySelectorAll('.theme-btn').forEach(btn => btn.classList.remove('active'));
            renderParagraphs();
            updateDashboard();
        }
        
        // Toggle dashboard visibility
        function toggleDashboard() {
            dashboardVisible = !dashboardVisible;
            document.getElementById('dashboard').style.display = dashboardVisible ? 'grid' : 'none';
        }
        
        // Filter paragraphs
        function getFilteredParagraphs() {
            let results = data.paragraphs;
            
            if (selectedThemes.length > 0) {
                results = results.filter(para => 
                    para.themes.some(theme => selectedThemes.includes(theme))
                );
            }
            
            if (searchTerm.trim()) {
                const term = searchTerm.toLowerCase();
                results = results.filter(para => 
                    para.Text.toLowerCase().includes(term) ||
                    para['Document Name'].toLowerCase().includes(term) ||
                    (para.Labels && para.Labels.toLowerCase().includes(term))
                );
            }
            
            return results;
        }
        
        // Text analysis functions
        function getWords(text) {
            return text.toLowerCase()
                .replace(/[^a-z0-9\s]/g, ' ')
                .split(/\s+/)
                .filter(word => word.length > 2 && !stopwords.has(word));
        }
        
        function getTermFrequency(paragraphs) {
            const freq = {};
            paragraphs.forEach(para => {
                const words = getWords(para.Text);
                words.forEach(word => {
                    freq[word] = (freq[word] || 0) + 1;
                });
            });
            return Object.entries(freq)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 10);
        }
        
        function getBigrams(paragraphs) {
            const bigrams = {};
            paragraphs.forEach(para => {
                const words = getWords(para.Text);
                for (let i = 0; i < words.length - 1; i++) {
                    const bigram = words[i] + ' ' + words[i + 1];
                    bigrams[bigram] = (bigrams[bigram] || 0) + 1;
                }
            });
            return Object.entries(bigrams)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 10);
        }
        
        function getThemeDistribution(paragraphs) {
            const dist = {};
            paragraphs.forEach(para => {
                para.themes.forEach(theme => {
                    dist[theme] = (dist[theme] || 0) + 1;
                });
            });
            return Object.entries(dist)
                .sort((a, b) => b[1] - a[1]);
        }
        
        // Update dashboard
        function updateDashboard() {
            const filtered = getFilteredParagraphs();
            
            // Basic stats
            const totalWords = filtered.reduce((sum, para) => sum + para.Text.split(/\s+/).length, 0);
            const allWords = filtered.flatMap(para => getWords(para.Text));
            const uniqueTerms = new Set(allWords).size;
            const avgWords = filtered.length > 0 ? Math.round(totalWords / filtered.length) : 0;
            
            document.getElementById('filteredCount').textContent = filtered.length;
            document.getElementById('totalWords').textContent = totalWords.toLocaleString();
            document.getElementById('uniqueTerms').textContent = uniqueTerms;
            document.getElementById('avgWords').textContent = avgWords;
            
            // Top terms
            const topTerms = getTermFrequency(filtered);
            const maxTermFreq = topTerms.length > 0 ? topTerms[0][1] : 1;
            document.getElementById('topTerms').innerHTML = topTerms.length > 0 
                ? topTerms.map(([term, count]) => `
                    <div class="term-bar">
                        <div class="term-label">${term}</div>
                        <div class="term-bar-bg">
                            <div class="term-bar-fill" style="width: ${(count / maxTermFreq) * 100}%"></div>
                        </div>
                        <div class="term-count">${count}</div>
                    </div>
                `).join('')
                : '<div class="empty-state">No terms to display</div>';
            
            // Top bigrams
            const topBigrams = getBigrams(filtered);
            const maxBigramFreq = topBigrams.length > 0 ? topBigrams[0][1] : 1;
            document.getElementById('topBigrams').innerHTML = topBigrams.length > 0
                ? topBigrams.map(([bigram, count]) => `
                    <div class="term-bar">
                        <div class="term-label">${bigram}</div>
                        <div class="term-bar-bg">
                            <div class="term-bar-fill" style="width: ${(count / maxBigramFreq) * 100}%"></div>
                        </div>
                        <div class="term-count">${count}</div>
                    </div>
                `).join('')
                : '<div class="empty-state">No bigrams to display</div>';
            
            // Theme distribution
            const themeDist = getThemeDistribution(filtered);
            const maxThemeCount = themeDist.length > 0 ? themeDist[0][1] : 1;
            document.getElementById('themeDistribution').innerHTML = themeDist.length > 0
                ? themeDist.map(([theme, count]) => `
                    <div class="term-bar">
                        <div class="term-label" style="min-width: 150px;">${theme.split(' ')[0]}...</div>
                        <div class="term-bar-bg">
                            <div class="term-bar-fill" style="width: ${(count / maxThemeCount) * 100}%"></div>
                        </div>
                        <div class="term-count">${count}</div>
                    </div>
                `).join('')
                : '<div class="empty-state">No themes to display</div>';
        }
        
        // Highlight text
        function highlightText(text) {
            if (!searchTerm.trim()) return text;
            
            const regex = new RegExp(`(${searchTerm.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')})`, 'gi');
            return text.replace(regex, '<span class="highlight">$1</span>');
        }
        
        // Render paragraphs
        function renderParagraphs() {
            const filtered = getFilteredParagraphs();
            const container = document.getElementById('paragraphs');
            const resultsInfo = document.getElementById('resultsInfo');
            const resultsCount = document.getElementById('resultsCount');
            
            // Show/hide results info
            if (searchTerm || selectedThemes.length > 0) {
                resultsInfo.style.display = 'flex';
                resultsCount.textContent = `${filtered.length} paragraph${filtered.length !== 1 ? 's' : ''} found`;
            } else {
                resultsInfo.style.display = 'none';
            }
            
            // Render paragraphs
            if (filtered.length === 0) {
                container.innerHTML = '<div class="paragraph-card"><p>No paragraphs found. Try different search terms or filters.</p></div>';
                return;
            }
            
            container.innerHTML = filtered.map((para, index) => `
                <div class="paragraph-card">
                    <div class="paragraph-id">¬∂ ${para['Paragraph ID']}</div>
                    <div class="paragraph-text">${highlightText(para.Text)}</div>
                    ${para.Labels ? `<div style="background: #edf2f7; padding: 8px; border-radius: 8px; margin-bottom: 10px;"><strong>Vulnerable Group:</strong> ${para.Labels}</div>` : ''}
                    <div class="theme-tags">
                        ${para.themes.map((theme, i) => `<span class="theme-tag tag-${allThemes.indexOf(theme) % 10}">${theme}</span>`).join('')}
                    </div>
                </div>
            `).join('');
        }
        
        // Start app
        init();
    </script>
</body>
</html>